# AtBlock Syntax

AtBlocks are special block-level constructs, often used for content that requires custom parsing or raw text handling, such as code blocks, images, or specialized directives.

## Syntax

```sommark
@_Identifier_@
Content...
@_end_@
```

- **Identifier**: The name of the AtBlock (e.g., `code`, `image`, `alert`).
- **Content**: The body of the block. For some AtBlocks (like code), this content is treated as raw text.
- **End**: Must be closed with `@_end_@`.

## Arguments

Arguments are passed immediately after the opening identifier.

### Positional
```sommark
@_Identifier_@:arg1;
```

### Key-Value
```sommark
@_Identifier_@:key:value1, value2;
```
----

### ⚠️ Atblock Examples

> [!WARNING]
> Most Atblock examples do **not** depend on default mappers.
> They showcase **custom mappers** to explain how raw content may be processed after parsing.
> Without a custom mapper registered, behavior may differ from what is illustrated.
> Confirm whether an example depends on a custom mapper before comparing results.


# SomMark – Atblock Examples

An Atblock is a **raw text container**.

Everything inside an Atblock is treated as **plain text**:

* No nesting
* No Block parsing
* No Inline parsing
* No syntax interpretation

Atblocks **must be inside a Block**.
They are not allowed at the top level.

---

## 1. Minimal Atblock

```
[Root]
@_Raw_@
This is plain text.
@_end_@
[end]
```

* `Raw` is the Identifier
* Body is treated as literal text
* No parsing occurs inside

---

## 2. Atblock Without Arguments

```
[Script]
@_Code_@: js;
function test() {
  return 1;
}
@_end_@
[end]
```

Everything inside is preserved exactly as written.

---

## 3. Atblock With Positional Arguments

```
[Data]
@_Json_@: compact, safe;
{"name": "Adam"}
@_end_@
[end]
```

* `compact` → positional argument
* `safe` → positional argument
* `;` ends argument definition

---

## 4. Atblock With Key-Value Arguments

```
[Config]
@_Env_@: mode:production, debug:false;
PORT=3000
@_end_@
[end]
```

* `mode` → key
* `production` → value
* `debug` → key
* `false` → value

---


## 5. Invalid Example – Missing Semicolon

**Invalid**:

```
@_Data_@: mode:prod
content
@_end_@
```

**Reason**:
When arguments are defined, they must end with `;`.

**Correct**:

```
@_Data_@: mode:prod;
content
@_end_@
```

---

## 6. Invalid Example – Top-Level Atblock

**Invalid**:

```
@_Raw_@
text
@_end_@
```

**Reason**:
Atblocks must be inside a Block.

**Correct**:

```
[Root]
@_Raw_@
text
@_end_@
[end]
```

---

## Summary

Atblock structure:

```
@_Identifier_@: optional arguments;
Plain text body
@_end_@
```

#### Rules:
* Must be inside a Block
* Body is always raw
* No nesting allowed
* Arguments optional
* `:` separates key-value
* `,` separates values
* `;` ends argument list
* Body cannot be empty
